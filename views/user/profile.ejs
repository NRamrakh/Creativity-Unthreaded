<%- include('../partials/header.ejs')%>
  <main>
    <br>
    <% if(events.length){%>
      <h2>
        <%= user.firstName%>,
      </h2>
      <h3>You are hosting the following events</h3> <br>

      <table class="profile_update">
        <tr class="profile_update">
          <th class="profile_update">Event topic</th>
          <th class="profile_update">Event name</th>
          <th class="profile_update">Actions</th>
        </tr>
        <% events.forEach(event=>{%>
          <tr class="profile_update">
            <td class="profile_update"><a href='/events/<%=event._id%>'>
                <p>
                  <%=event.topic%>
                </p>
              </a></td>
            <td class="profile_update"><a href='/events/<%=event._id%>'>
                <p>
                  <%=event.name%>
                </p>
              </a></td>
            <td class="profile_update">
              <form>
                <button class="buttons" type="submit" formmethod="GET"
                  formaction="/events/<%=event.id%>/edit">Update</button>
                <button class="buttons" type="submit" formmethod="POST"
                  formaction="/events/<%=event.id%>?_method=DELETE">Delete</button>
              </form>
            </td>

          </tr>

          <%});%>

      </table>





      <% } else{%>
        <p>You have not created any events</p>

        <% }%>
          <br><br>
          <% if(rsvp.length){%>
            <p>Your RSVPs</p>
            <table class="profile_update">
              <tr>
                <th class="profile_update">Event topic</th>
                <th class="profile_update">Event name</th>
                <th class="profile_update">Going?</th>
                <th class="profile_update">Actions</th>
              </tr>
              <% rsvp.forEach(rsvpData=>{%>
                <tr>
                  <td class="profile_update"><a href='/events/<%=rsvpData.eventId._id%>'>
                      <p>
                        <%=rsvpData.eventId.topic%>
                      </p>
                    </a></td>
                  <td class="profile_update"><a href='/events/<%=rsvpData.eventId._id%>'>
                      <p>
                        <%=rsvpData.eventId.name%>
                      </p>
                    </a></td>
                    <td class="profile_update"><a href='/events/<%=rsvpData.eventId._id%>'>
                      <p>
                        <%=rsvpData.rsvp%>
                      </p>
                    </a></td>
                  <td class="profile_update">
                    <form>
                      <button class="buttons" type="submit" formmethod="GET"
                        formaction="/events/<%=rsvpData.eventId._id%>">Update</button>
                      <button class="buttons" type="submit" formmethod="POST"
                        formaction="/rsvp/<%=rsvpData._id%>?_method=DELETE">Delete</button>
                    </form>
                  </td>

                  </td>

                </tr>

                <%});%>

            </table>
          <%}else{%>
            <p>You have not rsvped for any events</p>
          <%}%>

  </main>
  <%- include('../partials/footer.ejs')%>